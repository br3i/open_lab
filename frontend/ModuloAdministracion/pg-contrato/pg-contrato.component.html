<div class="card separador-componentes">
  <!-- Título principal de la tabla -->
  <p-toolbar>
    <div class="p-toolbar-group-center">
      <p><b>LISTADO DE CONTRATOS</b></p>
    </div>
  </p-toolbar>

  <!-- Tabla con las columnas especificadas -->
  <p-table [value]="lsListado" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
    [tableStyle]="{ 'min-width': '50rem' }" styleClass="p-datatable-sm"
    currentPageReportTemplate="Mostrar {first} - {last} de {totalRecords} contrato" [rowsPerPageOptions]="[10, 25, 50]">

    <!-- Cabecera de la tabla -->
    <ng-template pTemplate="header">
      <tr>

        <th style="width: 1200px; padding: 10px;">IDENTIFICADOR DEL CONTRATO</th>
        <th style="width: 1200px; padding: 10px;">TÍTULO DEL CONTRATO</th>
        <th style="width: 100px;">ESTADO</th>
        <th style="width: 200px;">ACCIONES</th>
      </tr>
    </ng-template>

    <!-- Cuerpo de la tabla -->
    <ng-template pTemplate="body" let-contrato>
      <tr>

        <td style="padding: 20px;">{{ contrato.oucontrato_stridentificador }}</td>
        <td style="padding: 20px;">{{ contrato.oucontrato_strtitulo }}</td> <!-- Título del contrato -->
        <td>
          <!-- Etiqueta para el estado del contrato -->
          <p-tag *ngIf="contrato.oucontrato_blestado == false" severity="danger" [value]="'DESACTIVADO'"></p-tag>
          <p-tag *ngIf="contrato.oucontrato_blestado == true" severity="success" [value]="'ACTIVO'"></p-tag>
        </td>
        <td>
          <!-- Botones de acción: Visualizar, Imprimir, Descargar, Cambiar estado -->
          <p-button type="button" icon="pi pi-eye" styleClass="p-button-text" (click)="visualizarContrato(contrato)"
            pTooltip="Visualizar" tooltipPosition="top">
          </p-button>
          <p-button type="button" icon="pi pi-download" styleClass="p-button-text" (click)="descargarContrato(contrato)"
            pTooltip="Descargar" tooltipPosition="top">
          </p-button>
          <p-button type="button" icon="pi pi-power-off" styleClass="p-button-text"
            (click)="ModalCambiarEstado(contrato)" pTooltip="Cambiar Estado" tooltipPosition="top">
          </p-button> <!-- Botón para confirmar cambio de estado -->
        </td>
      </tr>
    </ng-template>

  </p-table>
</div>

<!-- Ventana modal para confirmar el cambio de estado -->

<p-dialog header="Confirmar Cambio de Estado" [(visible)]="visibleEstado" [modal]="true" [closable]="false"
  [style]="{ width: '400px', borderRadius: '12px', boxShadow: '0px 8px 20px rgba(0, 0, 0, 0.15)' }"
  [contentStyle]="{ padding: '2rem', backgroundColor: '#ffffff', textAlign: 'center' }" class="estado-modal">
  <ng-template pTemplate="content">
    <div class="estado-content">
      <i class="pi pi-exclamation-triangle" style="font-size: 3rem; color: red; margin-bottom: 1rem;"></i>
      <p style="font-size: 1.2rem; font-weight: bold; margin-bottom: 0.5rem;">
        ¿Está seguro de realizar la acción de {{ this.contrato_blEstado.toLowerCase() }}?
      </p>
      <p style="font-size: 1.1rem; font-weight: bold; color: #333;">
        El "{{ objSeleccion.oucontrato_stridentificador }} "
      </p>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <div class="footer-buttons" style="display: flex; justify-content: center; gap: 0.5rem;">
      <!-- Botón Aceptar -->
      <p-button icon="pi pi-check" label="Aceptar" styleClass="custom-green-button-guardar"
        (click)="EstadoCambiarActualizacion()"></p-button>

      <!-- Botón Cancelar -->
      <p-button icon="pi pi-times" label="Cancelar" styleClass="custom-red-button-cancelar"
        (click)="visibleEstado = false"></p-button>
    </div>
  </ng-template>





</p-dialog>



<p-dialog header="Previsualización del Convenio" [(visible)]="visiblepdfContrato" [modal]="true"
  [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
  <ng-template pTemplate="header">
    <span class="text-xl font-bold">GENERACIÓN DOCUMENTO</span>
  </ng-template>
  <ng-template pTemplate="content">
    <div class="grid nested-grid">
      <div class="col-12">
        <div class="formgrid grid text-center">
          <div class="field col">
            <div class="text-center col-md-12 col-sm-12 col-xs-12" style="height: 450px;overflow: auto;">
              <iframe width="100%" height="100%" zoom_in="50%" [src]="strArchivoreporte64"></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</p-dialog>

<p-dialog header="Detalles del Convenio" [(visible)]="visibleDetalleContrato" [modal]="true"
  [style]="{ width: '60vw', borderRadius: '12px', boxShadow: '0px 8px 20px rgba(0, 0, 0, 0.2)' }"
  [contentStyle]="{ padding: '2rem', backgroundColor: '#f9f9f9' }" [draggable]="false" [resizable]="false"
  class="general-modal header-verde">
  <ng-template pTemplate="header">
    <span class="text-xl font-bold">Información del Convenio</span>
  </ng-template>

  <ng-template pTemplate="content">
    <div class="grid info-section">
      <div class="col-12">
        <label><b>Fecha de Registro</b></label>
        <input type="text" class="input-field"
          [value]="contratoSeleccionado.oucontrato_dtfecharegistro | date:'dd/MM/yyyy'" readonly>
      </div>
      <div class="col-12">
        <label><b>Estado</b></label>
        <input type="text" class="input-field"
          [value]="contratoSeleccionado.oucontrato_blestado ? 'Activo' : 'Inactivo'" readonly>
      </div>
      <div class="col-12">
        <label><b>Identificador</b></label>
        <input type="text" class="input-field" [value]="contratoSeleccionado.oucontrato_stridentificador" readonly>
      </div>
      <div class="col-12">
        <label><b>Título</b></label>
        <textarea rows="3" class="input-field" [value]="contratoSeleccionado.oucontrato_strtitulo" readonly></textarea>
      </div>

      <div class="col-12">
        <label><b>Introducción</b></label>
        <div class="descripcion-contrato" [innerHTML]="contratoSeleccionado.oucontrato_strdescripciono"></div>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <p-button icon="pi pi-check" label="Aceptar" styleClass="custom-green-button-guardar"
      (click)="CerrarModal('ModalDetalleContrato')"></p-button>
  </ng-template>
</p-dialog>