<div class="card separador-componentes">
  <p-toolbar>
    <div class="p-toolbar-group-center">
      <p>GESTION DE CONTRATO</p>
    </div>
  </p-toolbar>

<!-- Bot칩n flotante en esquina inferior derecha -->
<div class="boton-ayuda-fijo">
  <button
    pButton
    icon="pi pi-question-circle"
    class="p-button-rounded p-button-text"
    (click)="abrirAyuda()"
    type="button"
    title="Ver ayuda"
    style="font-size: 2.5rem;">
  </button>
</div>


  <div class="flex flex-column gap-2 mt-3">
    <label for="contrato">Identificador del Convenio</label>
    <input pInputText id="contrato" placeholder="Ingrese el Identificador del Convenio"
      [(ngModel)]="contrato_strIdentificador" />
  </div>

  <!-- Campo para introducir el titulo del contrato -->
  <div class="flex flex-column gap-2 mt-3">
    <label for="contrato">Titulo Convenio</label>
    <textarea id="contrato" pInputText placeholder="Ingrese el T칤tulo del Convenio" rows="5" cols="30"
      [(ngModel)]="contrato_strTitulo">
  </textarea>
  </div>

  <!-- Campo para introducir la descripcion del contrato -->
  <div class="flex flex-column gap-2 mt-3">
    <label for="contrato">Introducci칩n Convenio</label>
    <textarea id="contrato" pInputText placeholder="Ingrese la introducci칩n del Convenio" rows="5" cols="30"
      [(ngModel)]="contrato_strDescripcion">
  </textarea>
  </div>

  <br>
  <!-- Bot칩n para expandir/contraer la secci칩n de Cl치usulas -->
  <div class="card separador-componentes">
    <div class="flex justify-content-between">
      <div>
        <p-button label="Cl치usulas" icon="{{ expandirClausulas ? 'pi pi-chevron-up' : 'pi pi-chevron-down' }}"
          (click)="activarExpandirClausulas()" styleClass="p-button-text">
        </p-button>
      </div>
      <!-- Bot칩n para agregar nueva cl치usula (se ubica a la derecha) -->
      <div>
        <p-button type="button" icon="pi pi-plus" styleClass="p-button-text" (click)="ModalNuevoClausula()"
          pTooltip="Agregar Nuevo" tooltipPosition="top">
        </p-button>
      </div>
    </div>
    <div>
      <p-dialog header="Nueva Cl치usula" [(visible)]="visibleNuevaClausula" [modal]="true" [style]="{ width: '55vw' }"
        [draggable]="false" [resizable]="false" class="general-modal header-verde">

        <ng-template pTemplate="header">
          <span class="text-xl font-bold">Nueva Cl치usula</span>
        </ng-template>

        <ng-template pTemplate="content">
          <br>
          <p-button type="button" icon="pi pi-external-link" label="Lista de Cl치usulas" class="p-mb-3"
            (click)="  ModalDialogClausula()">
          </p-button>
          <div class="flex flex-column gap-2 mt-3">
            <label for="tituloClausula">T칤tulo de la Cl치usula</label>
            <input pInputText id="tituloClausula" placeholder="Ingrese el t칤tulo de la cl치usula"
              [(ngModel)]="clausula_strTitulo" /> <!-- Vinculado al modelo de t칤tulo -->
          </div>
          <div class="flex flex-column gap-2 mt-3">
            <label for="contenidoClausula">Contenido</label>
            <textarea id="contenidoClausula" rows="5" cols="30" pInputText
              placeholder="Ingrese el contenido de la cl치usula" [(ngModel)]="clausula_strDescripcion"
              style="width: 100%;">
            </textarea>
          </div>
        </ng-template>

        <ng-template pTemplate="footer">
          <p-button icon="pi pi-save" label="Guardar cl치usula" styleClass="custom-green-button-guardar"
            (click)="RegistrarNuevaClausula()"></p-button>
        </ng-template>
      </p-dialog>
    </div>

    <div *ngIf="expandirClausulas">
      <div class="container mt-2">
        <!-- Tabla de Cl치usulas -->
        <p-table [value]="ListadoClausula" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
          [tableStyle]="{ 'min-width': '10rem' }" styleClass="p-datatable-sm"
          currentPageReportTemplate="Mostrar {first} - {last} de {totalRecords} elementos"
          [rowsPerPageOptions]="[10, 25, 50]">

          <ng-template pTemplate="header">
            <tr>
              <th>#</th>
              <th pSortableColumn="nombre">T칈TULO DE LA CL츼USULA <p-sortIcon field="nombre"></p-sortIcon></th>
              <th>ACCIONES</th>
            </tr>
          </ng-template>

          <!-- Cuerpo de la tabla -->
          <ng-template pTemplate="body" let-clausula>
            <tr>
              <td>{{ clausula.idclausula }}</td>
              <td>{{ clausula.clausula_strtitulo }}</td>
              <td>
                <p-button type="button" icon="pi pi-eye" styleClass="p-button-text" (click)="VerClausula(clausula)"
                  pTooltip="Ver" tooltipPosition="top">
                </p-button>
                <p-button type="button" icon="pi pi-pencil" styleClass="p-button-text"
                  (click)="ModalEditarClausula(clausula)" pTooltip="Editar" tooltipPosition="top">
                </p-button>
                <p-button type="button" icon="pi pi-trash" styleClass="p-button-text"
                  (click)="ModalEliminarClausula(clausula)" pTooltip="Borrar" tooltipPosition="top">
                </p-button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>

    </div>
  </div>

  <div class="flex justify-content-between mt-3">
    <div class="p-toolbar-group-">
    </div>
    <div class="flex justify-content-start gap-2">
      <button type="button" label="Previsualizar" (click)="previsualizarContrato()" pButton icon="pi pi-eye"
        class="p-mr-3 p-button-info">
      </button>
      <p-button icon="pi pi-save" label="Guardar" styleClass="custom-green-button-guardar" (click)="guardarContrato()"></p-button>
    </div>

  </div>

  <!-- Modal para Cl치usula -->
  <p-dialog header="Detalle de la Cl치usula" [(visible)]="dialogVerClausulaVisible" [modal]="true"
    [style]="{width: '50vw'}" [draggable]="false" [resizable]="false">

    <ng-template pTemplate="content">
      <div class="p-fluid p-formgrid p-grid">
        <div class="p-field p-col-12">
          <label for="nombreClausula">T칤tulo de la Cl치usula</label>
          <input id="nombreClausula" type="text" pInputText [(ngModel)]="clausulaVisualizada.clausula_strtitulo"
            disabled />
        </div>
        <div class="p-field p-col-12">
          <label for="descripcionClausula">Descripci칩n</label>
          <textarea id="descripcionClausula" rows="10" cols="30" pInputText
            [(ngModel)]="clausulaVisualizada.clausula_strdescripcion" class="p-inputtext-sm" style="width: 100%;">
              </textarea>
        </div>
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <p-button label="Cerrar" icon="pi pi-times" (click)="dialogVerClausulaVisible = false">
      </p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Editar Cl치usula" [(visible)]="visibleEditarClausula" [modal]="true" [style]="{ width: '75vw' }"
    [draggable]="false" [resizable]="false" class="general-modal header-verde">

    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Editar Cl치usula</span>
    </ng-template>

    <ng-template pTemplate="content">
      <div class="flex flex-column gap-2 mt-3">
        <label for="tituloClausula">T칤tulo de la Cl치usula</label>
        <input pInputText id="tituloClausula" placeholder="Ingrese el t칤tulo de la Cl치usula"
          [(ngModel)]="clausulaSeleccionada.clausula_strtitulo" />
      </div>
      <div class="flex flex-column gap-2 mt-3">
        <label for="contenidoCausula">Contenido de la Cl치usula</label>
        <textarea pInputText id="contenidoClausula" rows="5" placeholder="Ingrese el contenido de la Cl치usula"
          [(ngModel)]="clausulaSeleccionada.clausula_strdescripcion" style="width: 100%;">
        </textarea>
      </div>
      <br>
      <div class="card separador-componentes">
        <div class="flex justify-content-between">
          <div>
            <p-button label="Subcl치usulas" icon="{{ expandedSubclausulas ? 'pi pi-chevron-up' : 'pi pi-chevron-down' }}"
              (click)="activarExpandirSubclausulas()" styleClass="p-button-text">
            </p-button>
          </div>
          <div>
            <p-button type="button" icon="pi pi-plus" styleClass="p-button-text" (click)="ModalNuevoSubclausula()"
              pTooltip="Agregar Nuevo" tooltipPosition="top">
            </p-button>
          </div>
        </div>
        <div *ngIf="expandedSubclausulas">
          <div class="container mt-2">
            <p-table [value]="ListadoSubclausula" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
              [tableStyle]="{ 'min-width': '10rem' }" styleClass="p-datatable-sm"
              currentPageReportTemplate="Mostrar {first} - {last} de {totalRecords} elementos"
              [rowsPerPageOptions]="[10, 25, 50]">

              <ng-template pTemplate="header">
                <tr>
                  <th>#</th>
                  <th pSortableColumn="nombre">T칈TULO DE LA SUBCL츼USULA <p-sortIcon field="nombre"></p-sortIcon>
                  </th>
                  <th>ACCIONES</th>
                </tr>
              </ng-template>

              <ng-template pTemplate="body" let-subclausula>
                <tr>
                  <td>{{ subclausula.ouclau_sub_idsubclausula }}</td>
                  <td>{{ subclausula.ousubclausula_strtitulo }}</td>
                  <td>
                    <p-button type="button" icon="pi pi-eye" styleClass="p-button-text"
                      (click)="VerSubclausula(subclausula)" pTooltip="Ver" tooltipPosition="top">
                    </p-button>
                    <p-button type="button" icon="pi pi-pencil" styleClass="p-button-text"
                      (click)="ModalEditarSubclausula(subclausula)" pTooltip="Editar" tooltipPosition="top">
                    </p-button>
                    <p-button type="button" icon="pi pi-trash" styleClass="p-button-text"
                      (click)="ModalEliminarSubclausula(subclausula)" pTooltip="Borrar" tooltipPosition="top">
                    </p-button>
                  </td>
                </tr>
              </ng-template>
            </p-table>

          </div>
        </div>
      </div>
    </ng-template>

    <!--Opciones para editar y eliminar cl치usula -->
    <ng-template pTemplate="footer">
      <div class="flex justify-content-end w-full">
        <div class="flex align-items-center" style="gap: 6ch;">
          <p-button icon="pi pi-times" label="Cerrar" styleClass="custom-red-button-cancelar"
            (click)="visibleEditarClausula = false">
          </p-button>
          <p-button icon="pi pi-save" label="Guardar" styleClass="custom-button p-button-sm"
            (click)="ActualizarClausula()">
          </p-button>
        </div>
      </div>
    </ng-template>
  </p-dialog>

  <p-dialog header="Lista de Cl치usulas" [resizable]="false" [modal]="true" [maximizable]="true" appendTo="body"
    [(visible)]="dialogClausulasVisible" [style]="{width: '75vw'}" [contentStyle]="{height: '300px'}">

    <div class="flex justify-content-end align-items-center mb-4">
      <div class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input type="text" pInputText placeholder="B칰squeda global" (input)="filtrarClausula($event)" />
      </div>
    </div>

    <p-table [value]="ListadoClausulaActivasFiltrado" [(selection)]="selectedClausulas" selectionMode="multiple"
      dataKey="idclausula" [scrollable]="true" scrollHeight="flex" [tableStyle]="{'min-width': '50rem'}">

      <ng-template pTemplate="header">
        <tr>
          <th style="width: 4rem"></th>
          <th>T칈TULO</th>
          <th>DESCRIPCI칍N</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-clausula>
        <tr [pSelectableRow]="clausula">
          <td>
            <p-tableCheckbox [value]="clausula"></p-tableCheckbox>
          </td>
          <td>{{clausula.clausula_strtitulo}}</td>
          <td>{{clausula.clausula_strdescripcion}}</td>
        </tr>
      </ng-template>
    </p-table>

    <ng-template pTemplate="footer">
      <p-button icon="pi pi-save" label="Confirmar selecci칩n" styleClass="custom-green-button-guardar"
        (click)="confirmarClausulas()"></p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Elminar Cl치usula" [(visible)]="visibleEliminarClausula" [modal]="true" [style]="{ width: '25vw' }"
    [draggable]="false" [resizable]="false">
    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Eliminar Cl치usula</span>
    </ng-template>

    <ng-template pTemplate="content">
      <div class="p-inputgroup">
        <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
        </span>
        <input pInputText placeholder="T칤tulo" [(ngModel)]="clausulaSeleccionada.clausula_strtitulo"
          class="p-inputtext-sm" readonly />
      </div>
    </ng-template>
    <ng-template pTemplate="footer">
      <p-button icon="pi pi-save" label="Guardar" styleClass="custom-green-button-guardar" (click)="EliminarClausula()"></p-button>
    </ng-template>
  </p-dialog>

  <!-- Modal para subcl치usula -->
  <p-dialog header="Nueva Subcl치usula" [(visible)]="visibleNuevaSubclausula" [modal]="true" [style]="{ width: '55vw' }"
    [draggable]="false" [resizable]="false" class="general-modal header-verde">

    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Nueva Subcl치usula</span>
    </ng-template>
    <ng-template pTemplate="content">
      <br>
      <p-button type="button" icon="pi pi-external-link" label="Lista de Subcl치usulas" class="p-mb-3"
        (click)="ModalDialogSubclausula()">
      </p-button>
      <div class="flex flex-column gap-2 mt-3">
        <label for="tituloClausula">T칤tulo de la Subcl치usula</label>
        <input pInputText id="tituloSubclausula" placeholder="Ingrese el t칤tulo de la subcl치usula"
          [(ngModel)]="subclausula_strTitulo" />
      </div>
      <div class="flex flex-column gap-2 mt-3">
        <label for="contenidoSubclausula">Contenido</label>
        <textarea id="contenidoSubclausula" rows="5" cols="30" pInputText
          placeholder="Ingrese el contenido de la subcl치usula" [(ngModel)]="subclausula_strDescripcion"
          style="width: 100%;">
                    </textarea>
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <p-button icon="pi pi-save" label="Guardar subcl치usula" styleClass="custom-green-button-guardar"
        (click)="RegistrarNuevaSubclausula()"></p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Lista de Subcl치usulas" [resizable]="false" [modal]="true" [maximizable]="true" appendTo="body"
    [(visible)]="dialogSubclausulasVisible" [style]="{width: '75vw'}" [contentStyle]="{height: '300px'}">

    <div class="flex justify-content-end align-items-center mb-4">
      <div class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input type="text" pInputText placeholder="B칰squeda global" (input)="filtrarSubclausula($event)" />
      </div>
    </div>
    <p-table [value]="ListadoSubclausulaActivasFiltradas" [(selection)]="selectedSubclausulas" selectionMode="multiple"
      dataKey="ouclau_sub_idsubclausula" [scrollable]="true" scrollHeight="flex" [tableStyle]="{'min-width': '50rem'}">

      <ng-template pTemplate="header">
        <tr>
          <th style="width: 4rem"></th>
          <th>T칈TULO</th>
          <th>DESCRIPCI칍N</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-subclausula>
        <tr [pSelectableRow]="subclausula">
          <td>
            <p-tableCheckbox [value]="subclausula"></p-tableCheckbox>
          </td>
          <td>{{subclausula.ousubclausula_strtitulo}}</td>

          <td>{{subclausula.ousubclausula_strdescripcion}}</td>

        </tr>
      </ng-template>
    </p-table>

    <ng-template pTemplate="footer">
      <p-button icon="pi pi-check" label="Confirmar selecci칩n" styleClass="custom-green-button-guardar"
        (click)="confirmarSubclausulas()"></p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Detalle de la Subcl치usula" [(visible)]="dialogVerSubclausulaVisible" [modal]="true"
    [style]="{width: '50vw'}" [draggable]="false" [resizable]="false" class="general-modal header-verde">

    <ng-template pTemplate="content">
      <div class="p-fluid p-formgrid p-grid">
        <div class="p-field p-col-12">
          <label for="nombreSubclausula">T칤tulo de la Subcl치usula</label>
          <input id="nombreSubclausula" type="text" pInputText
            [(ngModel)]="subclausulaVisualizada.ousubclausula_strtitulo" disabled />
        </div>
        <div class="p-field p-col-12">
          <label for="descripcionSubclausula">Descripci칩n</label>
          <textarea id="descripcionSubclausula" rows="10" cols="30" pInputText
            [(ngModel)]="subclausulaVisualizada.ousubclausula_strdescripcion" class="p-inputtext-sm"
            style="width: 100%;">
          </textarea>
        </div>
      </div>
    </ng-template>
    <ng-template pTemplate="footer">
      <p-button label="Cerrar" icon="pi pi-times" (click)="dialogVerSubclausulaVisible = false">
      </p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Editar Subcl치usula" [(visible)]="visibleEditarSubclausula" [modal]="true"
    [style]="{ width: '75vw' }" [draggable]="false" [resizable]="false" class="general-modal header-verde">

    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Editar Subcl치usula</span>
    </ng-template>

    <ng-template pTemplate="content">
      <div class="flex flex-column gap-2 mt-3">
        <label for="tituloSubclausula">T칤tulo de la Subcl치usula</label>
        <input pInputText id="tituloSubclausula" placeholder="Ingrese el t칤tulo de la SubCl치usula"
          [(ngModel)]="subclausulaSeleccionada.ousubclausula_strtitulo" />
      </div>

      <div class="flex flex-column gap-2 mt-3">
        <label for="contenidoSubclausula">Contenido de la Subcl치usula</label>
        <textarea pInputText id="contenidoSubclausula" rows="5" placeholder="Ingrese el contenido de la Subcl치usula"
          [(ngModel)]="subclausulaSeleccionada.ousubclausula_strdescripcion" style="width: 100%;">
                      </textarea>
      </div>

      <div class="card separador-componentes">
        <div class="flex justify-content-between">
          <div>
            <p-button label="Items" icon="{{ expandedItems ? 'pi pi-chevron-up' : 'pi pi-chevron-down' }}"
              (click)="activarExpandirItems()" styleClass="p-button-text">
            </p-button>
          </div>

          <div>
            <p-button type="button" icon="pi pi-plus" styleClass="p-button-text" (click)="ModalNuevoItem()"
              pTooltip="Agregar Nuevo" tooltipPosition="top">
            </p-button>
          </div>
        </div>

        <div *ngIf="expandedItems">
          <div class="container mt-2">
            <p-table [value]="ListadoItem" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
              [tableStyle]="{ 'min-width': '10rem' }" styleClass="p-datatable-sm"
              currentPageReportTemplate="Mostrar {first} - {last} de {totalRecords} elementos"
              [rowsPerPageOptions]="[10, 25, 50]">

              <ng-template pTemplate="header">
                <tr>
                  <th>#</th>
                  <th pSortableColumn="nombre">T칈TULO DEL ITEM <p-sortIcon field="nombre"></p-sortIcon>
                  </th>
                  <th>ACCIONES</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-item>
                <tr>
                  <td>{{ item.ousub_items_iditems }}</td>
                  <td>{{ item.ouitems_strtitulo }}</td>
                  <td>
                    <p-button type="button" icon="pi pi-eye" styleClass="p-button-text" (click)="VerItem(item)"
                      pTooltip="Ver" tooltipPosition="top">
                    </p-button>
                    <p-button type="button" icon="pi pi-pencil" styleClass="p-button-text"
                      (click)="ModalEditarItem(item)" pTooltip="Editar" tooltipPosition="top">
                    </p-button>
                    <p-button type="button" icon="pi pi-trash" styleClass="p-button-text"
                      (click)="ModalEliminarItem(item)" pTooltip="Borrar" tooltipPosition="top">
                    </p-button>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </div>
    </ng-template>

    <!-- Opciones de editar y eliminar Subcl치usulas -->
    <ng-template pTemplate="footer">
      <div class="flex justify-content-end w-full">
        <div class="flex align-items-center" style="gap: 6ch;">
          <p-button icon="pi pi-times" label="Cerrar" styleClass="custom-red-button-cancelar"
            (click)="visibleEditarSubclausula = false">
          </p-button>
          <p-button icon="pi pi-save" label="Actualizar" styleClass="custom-button p-button-sm"
            (click)="ActualizarSubclausula()">
          </p-button>
        </div>
      </div>
    </ng-template>


  </p-dialog>

  <p-dialog header="Elminar Subcl치usula" [(visible)]="visibleEliminarSubclausula" [modal]="true"
    [style]="{ width: '25vw' }" [draggable]="false" [resizable]="false">
    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Eliminar Subcl치usula</span>
    </ng-template>

    <ng-template pTemplate="content">
      <div class="p-inputgroup">
        <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
        </span>
        <input pInputText placeholder="T칤tulo" [(ngModel)]="subclausulaSeleccionada.ousubclausula_strtitulo"
          class="p-inputtext-sm" readonly />
      </div>
    </ng-template>
    <ng-template pTemplate="footer">
      <p-button icon="pi pi-save" label="Guardar" styleClass="custom-green-button-guardar" (click)="EliminarSubclausula()"></p-button>
    </ng-template>
  </p-dialog>

  <!-- Modal para intems -->

  <p-dialog header="Nuevo Item" [(visible)]="visibleNuevoItem" [modal]="true" [style]="{ width: '55vw' }"
    [draggable]="false" [resizable]="false" class="general-modal header-verde">

    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Nuevo Item</span>
    </ng-template>
<br>
    <ng-template pTemplate="content">
      <p-button type="button" icon="pi pi-external-link" label="Lista de Items" class="p-mb-3"
        (click)="ModalDialogItem()">
      </p-button>

      <div class="flex flex-column gap-2 mt-3">
        <label for="tituloItem">T칤tulo del Item</label>
        <input pInputText id="tituloItem" placeholder="Ingrese el t칤tulo del item" [(ngModel)]="items_strTitulo" />
      </div>

      <div class="flex flex-column gap-2 mt-3">
        <label for="contenidoItem">Contenido</label>
        <textarea id="contenidoItem" rows="5" cols="30" pInputText placeholder="Ingrese el contenido del item"
          [(ngModel)]="items_strDescripcion" style="width: 100%;">
                    </textarea>
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <p-button icon="pi pi-save" label="Guardar Item" styleClass="custom-green-button-guardar"
        (click)="RegistrarNuevoItem()"></p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Lista de Items" [resizable]="false" [modal]="true" [maximizable]="true" appendTo="body"
    [(visible)]="dialogItemVisible" [style]="{width: '75vw'}" [contentStyle]="{height: '300px'}">

    <div class="flex justify-content-end align-items-center mb-4">
      <div class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input type="text" pInputText placeholder="B칰squeda global" (input)="filtrarItem($event)" />
      </div>
    </div>

    <!-- Tabla de Items con checkboxes para seleccionar -->
    <p-table [value]="ListadoItemActivasFiltradas" [(selection)]="selectedItems" selectionMode="multiple"
      dataKey="ousub_items_iditems" [scrollable]="true" scrollHeight="flex" [tableStyle]="{'min-width': '50rem'}">

      <ng-template pTemplate="header">
        <tr>
          <th style="width: 4rem"></th> <!-- Espacio para el Checkbox -->
          <th>T칈TULO</th>
          <th>DESCRIPCI칍N</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-item>
        <tr [pSelectableRow]="item">
          <td>
            <p-tableCheckbox [value]="item"></p-tableCheckbox>
          </td>
          <td>{{item.ouitems_strtitulo}}</td>
          <td>{{item.ouitems_strdescripcion}}</td>
        </tr>
      </ng-template>
    </p-table>

    <!-- Bot칩n para confirmar y guardar las Items seleccionadas -->
    <ng-template pTemplate="footer">
      <p-button icon="pi pi-save" label="Confirmar selecci칩n" styleClass="custom-green-button-guardar"
        (click)="confirmarItems()"></p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Detalle del Item" [(visible)]="dialogVerItemVisible" [modal]="true" [style]="{width: '50vw'}"
    [draggable]="false" [resizable]="false" class="general-modal header-verde">

    <ng-template pTemplate="content">
      <div class="p-fluid p-formgrid p-grid">
        <div class="p-field p-col-12">
          <label for="nombreItem">T칤tulo del Item</label>
          <input id="nombreItem" type="text" pInputText [(ngModel)]="itemVisualizado.ouitems_strtitulo" disabled />
        </div>
        <div class="p-field p-col-12">
          <label for="descripcionItem">Descripci칩n</label>
          <textarea id="descripcionItem" rows="10" cols="30" pInputText
            [(ngModel)]="itemVisualizado.ouitems_strdescripcion" class="p-inputtext-sm" style="width: 100%;">
          </textarea>
        </div>
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <p-button label="Cerrar" icon="pi pi-times" (click)="dialogVerItemVisible = false">
      </p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Editar Item" [(visible)]="visibleEditarItem" [modal]="true" [style]="{ width: '75vw' }"
    [draggable]="false" [resizable]="false" class="general-modal header-verde">

    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Editar Item</span>
    </ng-template>

    <ng-template pTemplate="content">
      <div class="flex flex-column gap-2 mt-3">
        <label for="tituloItem">T칤tulo del Item</label>
        <input pInputText id="tituloItem" placeholder="Ingrese el t칤tulo del Item"
          [(ngModel)]="itemSeleccionado.ouitems_strtitulo" />
      </div>

      <div class="flex flex-column gap-2 mt-3">
        <label for="contenidoItem">Contenido del Item</label>
        <textarea pInputText id="contenidoItem" rows="5" placeholder="Ingrese el contenido del item"
          [(ngModel)]="itemSeleccionado.ouitems_strdescripcion" style="width: 100%;">
        </textarea>
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <div class="flex justify-content-end w-full">
        <div class="flex align-items-center" style="gap: 6ch;">
          <p-button icon="pi pi-times" label="Cerrar" styleClass="custom-red-button-cancelar"
            (click)="visibleEditarItem = false">
          </p-button>
          <p-button icon="pi pi-save" label="Actualizar" styleClass="custom-button p-button-sm" (click)="ActualizarItem()">
          </p-button>
        </div>
      </div>
    </ng-template>
  </p-dialog>

  <p-dialog header="Elminar Item" [(visible)]="visibleEliminarItem" [modal]="true" [style]="{ width: '25vw' }"
    [draggable]="false" [resizable]="false">
    <ng-template pTemplate="header">
      <span class="text-xl font-bold">Eliminar Item</span>
    </ng-template>
    <ng-template pTemplate="content">
      <div class="p-inputgroup">
        <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
        </span>
        <input pInputText placeholder="T칤tulo" [(ngModel)]="itemSeleccionado.ouitems_strtitulo" class="p-inputtext-sm"
          readonly />
      </div>
    </ng-template>
    <ng-template pTemplate="footer">
      <p-button icon="pi pi-save" label="Guardar" styleClass="custom-green-button-guardar" (click)="EliminarItem()"></p-button>
    </ng-template>
  </p-dialog>

  <p-dialog header="Previsualizaci칩n del Convenio" [(visible)]="visiblepdfContrato" [modal]="true"
    [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
    <ng-template pTemplate="header">
      <span class="text-xl font-bold">GENERACI칍N DOCUMENTO</span>
    </ng-template>
    <ng-template pTemplate="content">
      <div class="grid nested-grid">
        <div class="col-12">
          <div class="formgrid grid text-center">
            <div class="field col">
              <div class="text-center col-md-12 col-sm-12 col-xs-12" style="height: 450px;overflow: auto;">
                <iframe width="100%" height="100%" zoom_in="50%" [src]="strArchivoreporte64"></iframe>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
  </p-dialog>

  <p-dialog header="Gu칤a para estructurar convenios din치micos" [(visible)]="mostrarModalAyuda" [modal]="true"
    [style]="{ width: '65vw' }" class="general-modal header-verde">
    <br>
    <div class="modal-header">
      <p class="modal-subtitle">
        Esta gu칤a te orienta para escribir convenios que ser치n exportados a PDF, usando etiquetas simples y valores
        din치micos que se llenan autom치ticamente.
      </p>
    </div>

    <div class="info-section">
      <h4 class="section-title">游 Formato del contenido</h4>
      <p class="informacion-modal">
        Puedes utilizar etiquetas b치sicas (como negrita, listas, p치rrafos) para organizar mejor la informaci칩n del
        convenio. Estas etiquetas se procesan al generar el PDF para que tenga una presentaci칩n profesional.
      </p>

      <table class="table p-datatable-sm">
        <thead>
          <tr>
            <th>#</th>
            <th>Elemento</th>
            <th>Uso</th>
            <th>Sintaxis</th>
            <th>Ejemplo</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td><strong>Negrita</strong></td>
            <td>Resaltar nombres o datos clave</td>
            <td><code>&lt;strong&gt;Texto&lt;/strong&gt;</code></td>
            <td><strong>Texto</strong></td>
          </tr>
          <tr>
            <td>2</td>
            <td><em>Cursiva</em></td>
            <td>Usar en t칠rminos t칠cnicos o citas</td>
            <td><code>&lt;em&gt;Texto&lt;/em&gt;</code></td>
            <td><em>Texto</em></td>
          </tr>
          <tr>
            <td>3</td>
            <td>P치rrafo</td>
            <td>Separar ideas principales</td>
            <td><code>&lt;p&gt;Texto&lt;/p&gt;</code></td>
            <td>Bloque de texto</td>
          </tr>
          <tr>
            <td>4</td>
            <td>Salto de l칤nea</td>
            <td>Agregar espacio entre l칤neas</td>
            <td><code>\n</code></td>
            <td>Texto 1<br>Texto 2</td>
          </tr>
          <tr>
            <td>5</td>
            <td>Lista</td>
            <td>Presentar elementos o responsabilidades</td>
            <td><code>&lt;ul&gt;&lt;li&gt;Item&lt;/li&gt;&lt;/ul&gt;</code></td>
            <td>
              <ul>
                <li>Item</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td>6</td>
            <td>Lista numerada</td>
            <td>Pasos o art칤culos secuenciales</td>
            <td><code>&lt;ol&gt;&lt;li&gt;Paso&lt;/li&gt;&lt;/ol&gt;</code></td>
            <td>
              <ol>
                <li>Paso</li>
              </ol>
            </td>
          </tr>
          <tr>
            <td>7</td>
            <td>Separador</td>
            <td>Dividir secciones del documento</td>
            <td><code>&lt;hr /&gt;</code></td>
            <td>
              <hr />
            </td>
          </tr>
          <tr>
            <td>8</td>
            <td>Enlace</td>
            <td>Incluir p치ginas web</td>
            <td><code>&lt;a href="..."&gt;Texto&lt;/a&gt;</code></td>
            <td><a href="#">Visitar</a></td>
          </tr>
          <tr>
            <td>9</td>
            <td>Subrayado</td>
            <td>Dar 칠nfasis visual</td>
            <td><code>&lt;u&gt;Texto&lt;/u&gt;</code></td>
            <td><u>Texto</u></td>
          </tr>
          <tr>
            <td>10</td>
            <td>Justificado</td>
            <td>Texto alineado a ambos m치rgenes</td>
            <td><code>&lt;p style="text-align: justify;"&gt;</code></td>
            <td style="text-align: justify;">Texto alineado</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="info-section p-mt-4">
      <h4 class="section-title">游댐 Palabras clave din치micas</h4>
      <p class="informacion-modal">
        Estas palabras ser치n reemplazadas autom치ticamente por los datos del convenio o participantes. Escribe
        exactamente como se muestra:
      </p>

      <table class="table p-datatable-sm">
        <thead>
          <tr>
            <th>Palabra</th>
            <th>Descripci칩n</th>
            <th>Ejemplo</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>+NOMBRE_EMPRESA+</code></td>
            <td>Nombre de la empresa</td>
            <td>Fundaci칩n Vida Sana</td>
          </tr>
          <tr>
            <td><code>+NOMBRE_GERENTE+</code></td>
            <td>Gerente de la empresa</td>
            <td>Ing. Carla Mendoza</td>
          </tr>
          <tr>
            <td><code>+VIGENCIA+</code></td>
            <td>Duraci칩n del convenio</td>
            <td>01/07/2025 al 01/07/2026</td>
          </tr>
          <tr>
            <td><code>+NOMBRE_COORDINADOR+</code></td>
            <td>Coordinador del FUNDACI칍N FAVORITA</td>
            <td>Ing. Pedro Torres</td>
          </tr>
          <tr>
            <td><code>+NOMBRE_REPRESENTANTE+</code></td>
            <td>Representante de la empresa</td>
            <td>Lic. Ana Cueva</td>
          </tr>
          <tr>
            <td><code>+DIRRECION_EMPRESA+</code></td>
            <td>Direcci칩n de la empresa</td>
            <td>Av. Sim칩n Bol칤var 456</td>
          </tr>
          <tr>
            <td><code>+TELEFONO_EMPRESA+</code></td>
            <td>Tel칠fono de la empresa</td>
            <td>032-456-789</td>
          </tr>
          <tr>
            <td><code>+EMAIL_EMPRESA+</code></td>
            <td>Correo de la empresa</td>
            <td>info&#64;empresa.com</td>
          </tr>
          <tr>
            <td><code>+WEB_EMPRESA+</code></td>
            <td>Sitio web de la empresa</td>
            <td>www.empresa.com</td>
          </tr>
          <tr>
            <td><code>+CIUDAD_EMPRESA+</code></td>
            <td>Ciudad de la empresa</td>
            <td>Quito</td>
          </tr>
          <tr>
            <td><code>+FECHA_ACTUAL+</code></td>
            <td>Fecha de creaci칩n del PDF</td>
            <td>01 de julio de 2025</td>
          </tr>
          <tr>
            <td><code>+DIRRECION_BAR+</code></td>
            <td>Direcci칩n del FUNDACI칍N FAVORITA</td>
            <td>Calle Bol칤var 102</td>
          </tr>
          <tr>
            <td><code>+TELEFONO_BAR+</code></td>
            <td>Tel칠fono del FUNDACI칍N FAVORITA</td>
            <td>032-987-654</td>
          </tr>
          <tr>
            <td><code>+EMAIL_BAR+</code></td>
            <td>Correo del FUNDACI칍N FAVORITA</td>
            <td>contacto&#64;bar.org</td>
          </tr>
          <tr>
            <td><code>+WEB_BAR+</code></td>
            <td>Sitio web del FUNDACI칍N FAVORITA</td>
            <td>www.bar.org</td>
          </tr>
          <tr>
            <td><code>+CIUDAD_BAR+</code></td>
            <td>Ciudad del FUNDACI칍N FAVORITA</td>
            <td>Riobamba</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="p-mt-3">
      <p><strong>游늯 Ejemplo combinado:</strong></p>
      <pre><code>&lt;p&gt;La empresa +NOMBRE_EMPRESA+ representada por +NOMBRE_GERENTE+ se compromete a...&lt;/p&gt;\n&lt;p&gt;Vigencia: +VIGENCIA+&lt;/p&gt;</code></pre>
    </div>
  </p-dialog>

</div>
<!-- Toast para mensajes de 칠xito/error -->
<p-toast></p-toast>